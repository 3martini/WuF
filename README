WuF (Windows Update Forcer)

Introduction:

The WuF is a utility that forces the windows update agent to perform actions that normally must be performed via the windows update website or the agent GUI. It can be used locally or remotely. It is intended for use in an environment where many windows computers must be updated in discrete batches and where any useful scripting languages and executables are not permitted by draconian policy.

The WuF is composed of two parts, the controller (wuf_controller.bat) and the agent (wuf_agent.vbs). The agent is a standalone wrapper of the WSUS API, which allows you to scan for, download, and install windows updates on a single computer. It can be run locally or remotely.

The controller runs the agent on more than one computer at a time. The controller allows you to update batches of windows computers simultaneously. Feedback from the agents can be provided via command line or results can be dropped to a single network accessible location.

Usage:
Simply drop the WuF folder on a computer you intend to use as a command center. You will find two files:

wuf_controller.bat
agent\wuf_agent.vbs

Controller:

Pre-requisites:
 psexec on the command computer.

The controller will perform update operations on many computers. You provide the list of computers in a single newline delimited text file, and the controller will perform the requested action. The available actions are auto, scan, download, and install. Auto simply calls the computers windows update agent configured behavior. Scan only checks for missing updates. Download downloads missing updates. Install downloads and installs missing updates. You can also specify a network dropbox where the results of the script are dropped. The results include the number and enumeration of missing updates, the status of the requested operations, start/finish time, etc.

Agent:
The agent can be run separate from the controller. In this mode, it simply operates as a command line wrapper around WSUS. You can tell it to run the automatic operation, scan, download, or install.

